<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta name="generator" content="Hugo 0.80.0" />
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="合同式(mod)・逆元 # 最近知ったのだが、今は高校数学の課程に合同式が入っているそうだ。 自分はゆとり世代ゆえ正式には学んでない（予備校で少し">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="合同式(mod)・逆元" />
<meta property="og:description" content="合同式(mod)・逆元 # 最近知ったのだが、今は高校数学の課程に合同式が入っているそうだ。 自分はゆとり世代ゆえ正式には学んでない（予備校で少し" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://WAT36.github.io/pages/docs/programming/procon/inverse_mod/" />
<meta property="article:modified_time" content="2020-06-11T19:42:43+09:00" />
<title>合同式(mod)・逆元 | WAT Notes</title>
<link rel="manifest" href="https://WAT36.github.io/pages/manifest.json">
<link rel="icon" href="https://WAT36.github.io/pages/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="https://WAT36.github.io/pages/book.min.6c7c6446dfdee7c8c933e9bbc6e80ee3ed6c913b2a59519f2092c3c6a9d63e55.css" integrity="sha256-bHxkRt/e58jJM&#43;m7xugO4&#43;1skTsqWVGfIJLDxqnWPlU=">
<script defer src="https://WAT36.github.io/pages/en.search.min.62c3db65cfa15578ab23568a990cb6a08427e3010c976d28536806d986595539.js" integrity="sha256-YsPbZc&#43;hVXirI1aKmQy2oIQn4wEMl20oU2gG2YZZVTk="></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-161908250-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="https://WAT36.github.io/pages/"><span>WAT Notes</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  <ul>
<li><a href="https://WAT36.github.io/pages/docs/about/aboutme/"><strong>About me</strong></a></li>
</ul>
<details>
 <summary>Notes</summary>
<ul>
<li>
<ul>
<li><a href="https://WAT36.github.io/pages/docs/programming/jp_index/"><strong>プログラミング</strong></a></li>
<li><a href="https://WAT36.github.io/pages/docs/ctf/ctf_index/"><strong>CTF</strong></a></li>
<li><a href="https://WAT36.github.io/pages/docs/front-end/front_index/"><strong>フロントエンド</strong></a></li>
<li><a href="https://WAT36.github.io/pages/docs/cloud/aws/aws_index/"><strong>クラウド(AWS)</strong></a></li>
<li><a href="https://WAT36.github.io/pages/docs/container/container_index/"><strong>コンテナ</strong></a></li>
</ul>
</li>
</ul>
</details>
<ul>
<li>
<p><a href="https://WAT36.github.io/pages/posts/"><strong>Blog</strong></a></p>
</li>
<li>
<p><a href="https://WAT36.github.io/pages/docs/about/disclaimer/">免責事項</a></p>
</li>
</ul>










</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="https://WAT36.github.io/pages/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>合同式(mod)・逆元</strong>

  <label for="toc-control">
    
    <img src="https://WAT36.github.io/pages/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#合同式mod">合同式(mod)</a></li>
    <li><a href="#合同式の定理">合同式の定理</a>
      <ul>
        <li><a href="#合同式の和">合同式の和</a></li>
        <li><a href="#合同式の差">合同式の差</a></li>
        <li><a href="#合同式の積">合同式の積</a></li>
        <li><a href="#合同式のべき乗">合同式のべき乗</a></li>
        <li><a href="#合同式の除法">合同式の除法</a></li>
      </ul>
    </li>
    <li><a href="#逆元">逆元</a></li>
    <li><a href="#フェルマーの小定理">フェルマーの小定理</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="合同式mod逆元">
  合同式(mod)・逆元
  <a class="anchor" href="#%e5%90%88%e5%90%8c%e5%bc%8fmod%e9%80%86%e5%85%83">#</a>
</h1>
<p>最近知ったのだが、今は高校数学の課程に合同式が入っているそうだ。</p>
<p>自分はゆとり世代ゆえ正式には学んでない（予備校で少し出てきたことはあったが曖昧）ので、改めて学び直してみた。</p>
<p>同時に、競プロに関係する事項も。</p>
<h2 id="合同式mod">
  合同式(mod)
  <a class="anchor" href="#%e5%90%88%e5%90%8c%e5%bc%8fmod">#</a>
</h2>
<p>合同式とは以下の定義。</p>
<hr>
<p>a,bを整数、mを自然数とした時、</p>
<p>「aをmで割った余り」と「bをmで割った余り」が等しいことを以下の式で表す。</p>

<link rel="stylesheet" href="https://WAT36.github.io/pages/katex/katex.min.css" />
<script defer src="https://WAT36.github.io/pages/katex/katex.min.js"></script>
<script defer src="https://WAT36.github.io/pages/katex/auto-render.min.js" onload="renderMathInElement(document.body);"></script><span>
  \(\tag{1}
a  \equiv b \pmod{m}\)
</span>

<p>この式を<strong>合同式</strong>という。</p>
<hr>
<p>プログラムで表現するなら</p>
<pre><code>a%m == b%m
</code></pre><p>である。</p>
<h2 id="合同式の定理">
  合同式の定理
  <a class="anchor" href="#%e5%90%88%e5%90%8c%e5%bc%8f%e3%81%ae%e5%ae%9a%e7%90%86">#</a>
</h2>
<p>合同式には定理がいくつかある。</p>
<h3 id="合同式の和">
  合同式の和
  <a class="anchor" href="#%e5%90%88%e5%90%8c%e5%bc%8f%e3%81%ae%e5%92%8c">#</a>
</h3>
<p>整数a,b,c,d、自然数mにおいて　a≡b (mod m) ,c≡d (mod m) の時、以下の式が成立する。</p>
<span>
  \(\tag{2}
a&#43;c  \equiv b&#43;d \pmod{m}\)
</span>

<h3 id="合同式の差">
  合同式の差
  <a class="anchor" href="#%e5%90%88%e5%90%8c%e5%bc%8f%e3%81%ae%e5%b7%ae">#</a>
</h3>
<p>同様に、整数a,b,c,d、自然数mにおいて　a≡b (mod m) ,c≡d (mod m) の時、以下の式が成立する。</p>
<span>
  \(\tag{3}
a-c  \equiv b-d \pmod{m}\)
</span>

<h3 id="合同式の積">
  合同式の積
  <a class="anchor" href="#%e5%90%88%e5%90%8c%e5%bc%8f%e3%81%ae%e7%a9%8d">#</a>
</h3>
<p>同様に、整数a,b,c,d、自然数mにおいて　a≡b (mod m) ,c≡d (mod m) の時、以下の式が成立する。</p>
<span>
  \(\tag{4}
ac  \equiv bd \pmod{m}\)
</span>

<p>以上の式より、</p>
<span>
  \(\tag{5}
a&#43;c  \equiv b&#43;c \pmod{m} \\
a-c  \equiv b-c \pmod{m} \\
ac  \equiv bc \pmod{m} \)
</span>

<p>も成立し、これらの式から、合同式は移項・乗法も可能である。</p>
<h3 id="合同式のべき乗">
  合同式のべき乗
  <a class="anchor" href="#%e5%90%88%e5%90%8c%e5%bc%8f%e3%81%ae%e3%81%b9%e3%81%8d%e4%b9%97">#</a>
</h3>
<p>整数a,b、自然数mにおいて　a≡b (mod m) の時、以下の式が成立する。</p>
<span>
  \(\tag{6}
a^n  \equiv b^n \pmod{m}\)
</span>

<h4 id="証明">
  (証明)
  <a class="anchor" href="#%e8%a8%bc%e6%98%8e">#</a>
</h4>
<p>整数a,b,c,dを、自然数mと整数p,q,r,s,t,uを用い、以下のように定義する。</p>
<span>
  \(a = pm &#43; t \\
b = qm &#43; t \\
c = rm &#43; u \\
d = sm &#43; u \)
</span>

<p>この時、</p>
<span>
  \(a  \equiv b \pmod{m} \\
c  \equiv d \pmod{m}\)
</span>

<p>であり、また</p>
<span>
  \(\begin{aligned}
a&#43;c  &amp;= (p&#43;r)m &#43; (t&#43;u) \\
b&#43;d  &amp;= (q&#43;s)m &#43; (t&#43;u) \\
a-c  &amp;= (p-r)m &#43; (t-u) \\
b-d  &amp;= (q-s)m &#43; (t-u) \\
ac   &amp;= (prm &#43; pu&#43;tr)m &#43; tu \\
bd   &amp;= (qsm &#43; qu&#43;st)m &#43; tu \\
a^n  &amp;= (p^{n} m^{n-1} &#43; {}_n \mathrm{C} _1 p^{n-1} m^{n-2} t &#43; \cdots &#43; {}_n \mathrm{C} _{n-1} p t^{n-1})m &#43; t^n \\
b^n  &amp;= (q^{n} m^{n-1} &#43; {}_n \mathrm{C} _1 p^{n-1} m^{n-2} t &#43; \cdots &#43; {}_n \mathrm{C} _{n-1} p t^{n-1})m &#43; t^n
\end{aligned}\)
</span>

<p>である。これらより、</p>
<span>
  \(\begin{aligned}
a&#43;c  &amp; \equiv b&#43;d &amp; \pmod{m} \\
a-c  &amp; \equiv b-d &amp; \pmod{m} \\
ac   &amp; \equiv bd  &amp; \pmod{m} \\
a^n  &amp; \equiv b^n &amp; \pmod{m}
\end{aligned}\)
</span>

<p>が成立する。</p>
<h3 id="合同式の除法">
  合同式の除法
  <a class="anchor" href="#%e5%90%88%e5%90%8c%e5%bc%8f%e3%81%ae%e9%99%a4%e6%b3%95">#</a>
</h3>
<p>整数a,b,c、 自然数mにおいて　ab≡ac (mod m) の時でかつ<strong>aとmが互いに素</strong>の時、以下の式が成立する。</p>
<span>
  \(\tag{7}
\begin{aligned}
ab  &amp; \equiv ac &amp; \pmod{m} \\
\Leftrightarrow　b  &amp; \equiv c &amp; \pmod{m}
\end{aligned}\)
</span>

<h4 id="証明-1">
  (証明)
  <a class="anchor" href="#%e8%a8%bc%e6%98%8e-1">#</a>
</h4>
<p>ab≡ac (mod m)　、かつaとmが互いに素の時において</p>
<span>
  \(\tag{8}
\begin{aligned}
ab  &amp; \equiv ac &amp; \pmod{m} \\
\Leftrightarrow　ab-ac   &amp; \equiv 0 &amp; \pmod{m} \\
\Leftrightarrow　a(b-c)  &amp; \equiv 0 &amp; \pmod{m}
\end{aligned}\)
</span>

<p>となり、この式において、a(b-c)と0はmで割った余りが同じであり、0をmで割った余りは0なので、a(b-c)をmで割った余りも0、つまりa(b-c)はmで割り切れる(=mの倍数)ということになる。</p>
<p>aとmは互いに素なので、b-cがmの倍数という事になる。</p>
<p>これより、(b-c)≡0 (mod m)が成立するので、</p>
<span>
  \(\tag{9}
\begin{aligned}
(b-c)  &amp; \equiv 0 &amp; \pmod{m} \\
\Leftrightarrow　b   &amp; \equiv c &amp; \pmod{m} 
\end{aligned}\)
</span>

<p>となり、aとmが互いに素でab≡ac (mod m)の時、b≡c (mod m)が成立する。</p>
<p>ちなみに、aとmが互いに素ではない時、(b-c)がmの倍数でない場合があるため、これは成立しない。</p>
<hr>
<p>以上が、合同式についての定義及び定理の紹介である。</p>
<p>これらを踏まえ、次に逆元についてを述べる。</p>
<h2 id="逆元">
  逆元
  <a class="anchor" href="#%e9%80%86%e5%85%83">#</a>
</h2>
<p>modを使った方程式を解いてみることを考える。例えばa,bを整数、mを自然数とした、以下のような式があったとする。</p>
<span>
  \(\tag{10}
ax  \equiv b \pmod{m}\)
</span>

<p>この式でxを求めるにはどのようにすれば良いのだろうか。</p>
<p>この時、</p>
<span>
  \(\tag{11}
ay \equiv 1 \pmod{m}\)
</span>

<p>となるような整数yが存在した場合、合同式の積の定理から、</p>
<span>
  \(\tag{12}
\begin{aligned}
x &amp; \equiv x &amp; \pmod{m} \\
\Leftrightarrow 1 \cdot x &amp; \equiv ay \cdot x &amp; \pmod{m} \\
\Leftrightarrow x &amp; \equiv y \cdot ax &amp; \pmod{m} 
\end{aligned}\)
</span>

<span>
  \(\tag{13}
\begin{aligned}
ax &amp; \equiv b &amp; \pmod{m} \\
\Leftrightarrow y \cdot ax &amp; \equiv y \cdot b &amp; \pmod{m}
\end{aligned}\)
</span>

<p>が成り立つ。これより、</p>
<span>
  \(\tag{14}
\begin{aligned}
x &amp; \equiv y \cdot ax &amp; \pmod{m} \\
  &amp; \equiv y \cdot b &amp; \pmod{m}
\end{aligned}\)
</span>

<p>と求めることができる。</p>
<p>このように、a,mに対して</p>
<span>
  \(\tag{15}
ay \equiv 1 \pmod{m}\)
</span>

<p>となるような整数yのことを、aの<strong>逆元</strong>といい、大体はa<sup>-1</sup>と書く。</p>
<span>
  \(\tag{16}
a \cdot a^{-1} \equiv 1 \pmod{m}\)
</span>

<p>また、式(10)において、a,mが互いに素でない場合以下のように書き換えることもできる。</p>
<span>
  \(\tag{17}
\frac{ax}{gcd(a,m)}  \equiv \frac{b}{gcd(a,m)} \pmod{ \frac{m}{gcd(a,m)} }\)
</span>

<p>ここで、gcd(a,m)はaとmの最大公約数である。</p>
<p>式(14),(16),(17)より、式(10)の解は</p>
<span>
  \(\tag{18}
x  =  \left(\frac{a}{gcd(a,m)}\right)^{-1} \cdot \frac{b}{gcd(a,m)} &#43;  k \cdot \frac{m}{gcd(a,m)} \pmod{ m } \)
</span>

<p>となる。ただしkは0 ≦ k ≦ gcd(a,m)を満たす整数である。</p>
<h2 id="フェルマーの小定理">
  フェルマーの小定理
  <a class="anchor" href="#%e3%83%95%e3%82%a7%e3%83%ab%e3%83%9e%e3%83%bc%e3%81%ae%e5%b0%8f%e5%ae%9a%e7%90%86">#</a>
</h2>
<p>pが素数の時、任意の整数xに対して</p>
<span>
  \(\tag{19}
x^p  \equiv x \pmod{p}\)
</span>

<p>が成り立つ。</p>
<p>特にxがpで割り切れない場合(互いに素)の時は、合同式の除法より</p>
<span>
  \(\tag{20}
x^{p-1}  \equiv 1 \pmod{p}\)
</span>

<p>が成り立つ。</p>
<p>式(20)より</p>
<span>
  \(\tag{21}
x \cdot x^{p-2}  \equiv 1 \pmod{p}\)
</span>

<p>となるので、pが素数の時、整数xの逆元はx<sup>p-2</sup>であることもわかる。</p>
<!--
## オイラーの定理

フェルマーの小定理はpが素数の時のみ使える定理であった。pが素数でない(合成数)時はどのようにすれば良いのだろうか。

実はpが素数でない時は、**オイラーの定理**という定理が適用できる。

合成数pを

<span>
  \(\tag{22}
p = p_{1}^{e_{1}} p_{2}^{e_{2}} \cdots p_{n}^{e_{n}}\)
</span>


と表した時、オイラー関数φ(p)を以下のように定義する。

<span>
  \(\tag{23}
\phi(p) = p \prod_{i=1}^n \frac{p_{i}-1}{p_{i}}\)
</span>


式(23)は、実はp以下のpと互いに素な自然数の個数と等しくなる。

またこの時、pと互いに素な整数xについて、以下の式も成り立つ。

<span>
  \(\tag{24}
x^{\phi(p)}  \equiv 1 \pmod{p}\)
</span>

--><blockquote>
</blockquote>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">



  <div><a class="flex align-center" href="https://github.com/alex-shpak/hugo-book/commit/388f72adac4879581f3682ab03765f6f8301c0d0" title='Last modified by Wataru Tsukagoshi | Jun 11, 2020' target="_blank" rel="noopener">
      <img src="https://WAT36.github.io/pages/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>Jun 11, 2020</span>
    </a>
  </div>



  <div>
    <a class="flex align-center" href="https://github.com/alex-shpak/hugo-book/edit/master/exampleSite/content//docs/programming/procon/inverse_mod.md" target="_blank" rel="noopener">
      <img src="https://WAT36.github.io/pages/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>Edit this page</span>
    </a>
  </div>

</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#合同式mod">合同式(mod)</a></li>
    <li><a href="#合同式の定理">合同式の定理</a>
      <ul>
        <li><a href="#合同式の和">合同式の和</a></li>
        <li><a href="#合同式の差">合同式の差</a></li>
        <li><a href="#合同式の積">合同式の積</a></li>
        <li><a href="#合同式のべき乗">合同式のべき乗</a></li>
        <li><a href="#合同式の除法">合同式の除法</a></li>
      </ul>
    </li>
    <li><a href="#逆元">逆元</a></li>
    <li><a href="#フェルマーの小定理">フェルマーの小定理</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>

</html>












