---
title: "交差エントロピー誤差"
weight: 1
# bookFlatSection: false
# bookShowToC: true
bookToc: false
---

# 交差エントロピー誤差

前述のロジスティック回帰モデルにおいて、入力xがt＝1となる確率を次のように表す。

{{< katex  >}}
y  =  \sigma ( w_{0} x + w_{1} )  =  P(t=1 \mid x)
{{< /katex >}}

ここから、データに合うようなw_{0}とw_{1}を最尤推定法を用いて求めていく。

「このモデルから入力データが生成されたとして、最もありえる（確率の高い）パラメータを求める」という方針である。

まずは入力データそれぞれにおいてこのロジスティック回帰モデルから生成された確率（尤度）を求める。

上式yは入力xに対して出力tが1となる確率なので、入力データxに対しt＝1だったら、ロジスティック回帰モデルから生成される確率はこのロジスティック回帰モデルの出力そのものなのでyとなる。逆に入力データxに対しt＝0だったら、確率は1ーyである。

{{< katex  >}}
\tag{1}
\begin{aligned}
    P(t=1 \mid x) &= y \\
    P(t=0 \mid x) &= 1-y
\end{aligned}
{{< /katex >}}

しかし、この式をできればもう少し一般化して、どのような入力データにも適用できる形にしたい。

そこで、上式を以下のように書き換える。

{{< katex  >}}
\tag{2}
P(t \mid x) = y^t (1-y)^{1-t}
{{< /katex >}}

この式(1)と式(2)は同じ形になる。

この式を利用し、データがN個だった場合、入力データ<b>X</b>=x<sub>0</sub>,…x<sub>N-1</sub>に対し出力データ<b>T</b>=t<sub>0</sub>,…t<sub>N-1</sub>が得られる確率は、以下の式(3)で表される。

{{< katex  >}}
\tag{3}
\begin{aligned}
    P( { \bf T } \mid { \bf X } ) 
        &= \prod_{n=0}^{N-1} P( t_{n} \mid x_{n} )  \\
        &= \prod_{n=0}^{N-1} y_{n}^{t_{n}} (1-y_{n})^{1-t_{n}}
\end{aligned}
{{< /katex >}}

この式(3)が、データに対する尤度となる。

