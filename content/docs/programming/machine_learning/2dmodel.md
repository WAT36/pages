---
title: "2次元入力の面モデル"
weight: 1
# bookFlatSection: false
# bookShowToC: true
bookToc: false
---

# 2次元入力の面モデル


先程の勾配法の例では入力データは1次元であったが、2次元であった場合はどうだろうか。

例として、以下のようなデータを用意する。

(入力が2次元のデータを用意する)

これらに対して、2次元の入力値が与えられたときに予測値を返すような簡単な面を予測してみよう。


まず面の式についてだが、一般的に3次元において座標(x,y,z)を通る面の式は

ax+by+cz+d=0 (a,b,c,dは実数)

となっているが、これを変形することにより、(x0,x1)を入力したときに予測値tを返すような面の式は以下のように表される。

y=w0x0+w1x1+w2. (w0,w1,w2は実数)

この式を利用し、予測値と正解値の差の合計が最も小さくなるようなw0,w1,w2を算出することを考える。

先程の1次元の時と同様に、平均二乗誤差を算出し、解析解を求めてみる。

まず、平均二乗誤差Jは

J= 1/N Σ (y-t)^2
 = 1/N Σ (w0x0+w1x1+w2-t)^2

となり、このJが最も小さくなるようなw0,w1,w2を求めれば良い。

そうなるようなw0,w1,w2の値は、Jをw0,w1,w2でそれぞれ偏微分した時の値が０になる時である。

Jをw0,w1,w2でそれぞれ偏微分、また先ほどと同様に、avg(x)をxの平均値を算出する関数とおくと、各式は以下のように整理される。

(Jをw0,w1,w2でそれぞれ偏微分した結果を表示する)

この３式をそれぞれw0,w1,w2について解くと、w0,w1,w2は以下のように表される。

(w0,w1,w2の式を書く)

ここで、

var(a) = avg(a^2) - avg(a)^2

cov(a,b) = avg(ab)-avg(a)avg(b)

とする。var(a)はaの分散と呼ばれ、aのばらつき具合を示す値である。

cov(a,b)はa,bの共分散と呼ばれる値で、a,bがどれぐらい影響しあっているかを示す。

