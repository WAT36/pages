---
title: "最小全域木"
weight: 1
# bookFlatSection: false
# bookShowToC: true
---

# 最小全域木

無向グラフが与えられたときに、その内のある辺だけを用いてグラフ中の任意の２頂点を連結(ある頂点から他のどの頂点への経路が存在する)にした木のことを**全域木(Spanning Tree)**という。

辺にコストがあったときに、使われる辺のコストの和を最小にした全域木のことを**最小全域木(Minimum Spanning Tree)**という。

例えばベルマンフォード・ダイクストラ法で用いたグラフの最小全域木は以下のように表される。

![全域木例1](/img/procon/spanning_tree1.png)

最小全域木を求めるアルゴリズムとして、一般に**プリム法**と**クラスカル法**の2つが知られている。

## プリム法

プリム法は、グラフのある頂点から辺を付け足して行って最小全域木を求めていく手法である。

始め、1つの頂点vからなるグラフTを考えたとき、ここからグラフTとその他の頂点を結ぶ最小コストの辺をグラフTに追加していく、と言う操作を繰り返すことにより、最小全域木が作成できる。

プリム法のアルゴリズムは以下の通り。

入出力：

- 入力
 - グラフ G = (V,E)
 - W(a,b):頂点aから頂点b(a,b∈V)を結ぶ辺の重み(コスト)。辺が存在しないときはW(a,b)=∞
 - 頂点s (s∈V)
- 出力
 - 最小全域木 X = (V',E')

アルゴリズム：

1. X=a (a∈V)、Y=V-X とする。aは何でも良い。
2. 頂点x (x∈X) 、頂点y (y∈Y)を結ぶ辺で、Xに追加したときに閉路をなさない辺のうち、最小のコストを持つ辺eを探す。
3. X=X+(eのY側の要素)、Y=Y-(eのY側の要素)とする。
4. Y={} (|Y|=0) ならば、Xを出力して終了する。そうでない時は、2.に戻る。

例として、以下のグラフに対しプリム法を適用した場合を追って説明する。

![ダイクストラ例1](/img/procon/dijkstra1.png)

まずは頂点Aを最小全域木Xとし、その他の頂点をグラフYとする。

![プリム例1](/img/procon/prim1.png)

次に、グラフXとグラフYを結ぶ辺のうち、Xに加えた時に閉路をなさず、最小コストである辺を探す。この場合は、頂点A-Bを結ぶ辺が該当する。

この辺、及び、頂点BをXに加え、またYから除外する。

![プリム例2](/img/procon/prim2.png)

この動作を繰り返していく。この状態において、グラフXとグラフYを結ぶ辺のうち、Xに加えた時に閉路をなさず、最小コストである辺は、頂点B-Cを結ぶ辺が該当する。よって、頂点CをXに加え、またYから除外する。

![プリム例3](/img/procon/prim3.png)

次は、頂点A-Dを結ぶ辺が該当する。

![プリム例4](/img/procon/prim4.png)

次は、頂点D-Eを結ぶ辺が該当する。

![プリム例5](/img/procon/prim5.png)

Yの頂点がなくなったので、Xを出力して終了する。このXが、最小全域木である。