---
title: "最小全域木"
weight: 1
# bookFlatSection: false
# bookShowToC: true
---

# 最小全域木

無向グラフが与えられたときに、その内のある辺だけを用いてグラフ中の任意の２頂点を連結(ある頂点から他のどの頂点への経路が存在する)にした木のことを**全域木(Spanning Tree)**という。

辺にコストがあったときに、使われる辺のコストの和を最小にした全域木のことを**最小全域木(Minimum Spanning Tree)**という。

例えばベルマンフォード・ダイクストラ法で用いたグラフの最小全域木は以下のように表される。

![全域木例1](/img/procon/spanning_tree1.png)

最小全域木を求めるアルゴリズムとして、一般に**プリム法**と**クラスカル法**の2つが知られている。

## プリム法

プリム法は、グラフのある頂点から辺を付け足して行って最小全域木を求めていく手法である。

始め、1つの頂点vからなるグラフTを考えたとき、ここからグラフTとその他の頂点を結ぶ最小コストの辺をグラフTに追加していく、と言う操作を繰り返すことにより、最小全域木が作成できる。

プリム法のアルゴリズムは以下の通り。

入出力：

- 入力
 - グラフ G = (V,E)
 - W(a,b):頂点aから頂点b(a,b∈V)を結ぶ辺の重み(コスト)。辺が存在しないときはW(a,b)=∞
 - 頂点s (s∈V)
- 出力
 - 最小全域木 X = (V',E')

アルゴリズム：

1. X=a (a∈V)、Y=V-X とする。aは何でも良い。
2. 頂点x (x∈X) 、頂点y (y∈Y)を結ぶ辺で、Xに追加したときに閉路をなさない辺のうち、最小のコストを持つ辺eを探す。
3. X=X+(eのY側の要素)、Y=Y-(eのY側の要素)とする。
4. Y={} (|Y|=0) ならば、Xを出力して終了する。そうでない時は、2.に戻る。

例として、以下のグラフに対しプリム法を適用した場合を追って説明する。